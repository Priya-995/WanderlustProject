<% layout('/layouts/boilerplate') -%>

<div class="min-h-screen flex items-center justify-center  py-36 px-4 sm:px-6 lg:px-8">
    <div class="max-w-md w-full space-y-8">
        <!-- Form Card -->
        <div class="bg-white rounded-2xl shadow-xl p-8">
            <form action="/login" method="POST" class="space-y-6" id="loginForm" novalidate>
                <!-- Header -->
                <div class="text-center">
                    <h2 class="text-3xl font-extrabold text-gray-900">
                        Welcome back
                    </h2>
                    <p class="mt-2 text-sm text-gray-600">
                        Sign in to your account
                    </p>
                </div>

                <!-- Username Field -->
                <div>
                    <label for="username" class="block text-sm font-medium text-gray-700 mb-2">
                        Username
                    </label>
                    <input 
                        id="username" 
                        name="username" 
                        type="text" 
                        autocomplete="username"
                        class="appearance-none relative block w-full px-4 py-3 border border-gray-300 rounded-lg placeholder-gray-400 text-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition duration-150 ease-in-out sm:text-sm"
                        placeholder="Enter your username"
                    >
                    <p class="mt-2 text-xs text-red-600 hidden" id="usernameError"></p>
                </div>

                <!-- Password Field -->
                <div>
                    <label for="password" class="block text-sm font-medium text-gray-700 mb-2">
                        Password
                    </label>
                    <input 
                        id="password" 
                        name="password" 
                        type="password" 
                        autocomplete="current-password"
                        class="appearance-none relative block w-full px-4 py-3 border border-gray-300 rounded-lg placeholder-gray-400 text-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition duration-150 ease-in-out sm:text-sm"
                        placeholder="Enter your password"
                    >
                    <p class="mt-2 text-xs text-red-600 hidden" id="passwordError"></p>
                </div>

                <!-- Remember Me & Forgot Password -->
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <input 
                            id="remember" 
                            name="remember" 
                            type="checkbox"
                            class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded cursor-pointer"
                        >
                        <label for="remember" class="ml-2 block text-sm text-gray-700 cursor-pointer">
                            Remember me
                        </label>
                    </div>
                    <div class="text-sm">
                        <a href="/forgot-password" class="font-medium text-indigo-600 hover:text-indigo-500 transition duration-150 ease-in-out">
                            Forgot password?
                        </a>
                    </div>
                </div>

                <!-- Submit Button -->
                <div>
                    <button 
                        type="submit"
                        class="w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 ease-in-out transform hover:scale-[1.02] active:scale-[0.98]"
                    >
                        Sign in
                    </button>
                </div>

                <!-- Signup Link -->
                <div class="text-center">
                    <p class="text-sm text-gray-600">
                        Don't have an account? 
                        <a href="/signup" class="font-medium text-indigo-600 hover:text-indigo-500 transition duration-150 ease-in-out">
                            Sign up
                        </a>
                    </p>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('loginForm');
    const username = document.getElementById('username');
    const password = document.getElementById('password');
    
    const usernameError = document.getElementById('usernameError');
    const passwordError = document.getElementById('passwordError');

    // Validation functions
    function validateUsername(value) {
        if (!value || value.trim().length === 0) {
            return 'Username is required';
        }
        if (value.length < 3) {
            return 'Username must be at least 3 characters long';
        }
        return null;
    }

    function validatePassword(value) {
        if (!value || value.length === 0) {
            return 'Password is required';
        }
        return null;
    }

    function showError(input, errorElement, message) {
        input.classList.remove('border-gray-300', 'focus:ring-indigo-500');
        input.classList.add('border-red-500', 'focus:ring-red-500');
        errorElement.textContent = message;
        errorElement.classList.remove('hidden');
    }

    function clearError(input, errorElement) {
        input.classList.remove('border-red-500', 'focus:ring-red-500');
        input.classList.add('border-gray-300', 'focus:ring-indigo-500');
        errorElement.classList.add('hidden');
    }

    // Real-time validation on blur
    username.addEventListener('blur', function() {
        const error = validateUsername(this.value);
        if (error) {
            showError(username, usernameError, error);
        } else {
            clearError(username, usernameError);
        }
    });

    username.addEventListener('input', function() {
        if (usernameError.textContent) {
            const error = validateUsername(this.value);
            if (!error) {
                clearError(username, usernameError);
            }
        }
    });

    password.addEventListener('blur', function() {
        const error = validatePassword(this.value);
        if (error) {
            showError(password, passwordError, error);
        } else {
            clearError(password, passwordError);
        }
    });

    password.addEventListener('input', function() {
        if (passwordError.textContent) {
            const error = validatePassword(this.value);
            if (!error) {
                clearError(password, passwordError);
            }
        }
    });

    // Form submission validation
    form.addEventListener('submit', function(e) {
        e.preventDefault();
        
        let isValid = true;
        
        // Validate username
        const usernameErr = validateUsername(username.value);
        if (usernameErr) {
            showError(username, usernameError, usernameErr);
            isValid = false;
        } else {
            clearError(username, usernameError);
        }
        
        // Validate password
        const passwordErr = validatePassword(password.value);
        if (passwordErr) {
            showError(password, passwordError, passwordErr);
            isValid = false;
        } else {
            clearError(password, passwordError);
        }
        
        // If all valid, submit the form
        if (isValid) {
            form.submit();
        }
    });
});
</script>